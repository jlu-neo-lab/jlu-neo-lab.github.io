# Excel 数据读取脚本使用指南

## 概述

这个脚本可以读取包含成员信息的 Excel 文件，并将其转换为网站可用的 JavaScript 数据格式。

## Excel 文件格式要求

Excel 文件应包含以下表头（顺序不限）：

| 表头 | 说明 | 示例 |
|------|------|------|
| Name | 成员姓名 | "张三 (Zhang San)" |
| Email | 电子邮件 | "zhangsan@jlu.edu.cn" |
| 入学时间/学院 | 入学年份和所属学院 | "2023/计算机科学与技术学院" |
| 研究兴趣 | 研究领域，多个用逗号分隔 | "机器学习,深度学习,计算机视觉" |
| 个人主页 | 个人网站链接 | "https://example.com" |
| 自传 | 个人简介 | "张三是一名专注于机器学习的研究生..." |

## 安装依赖

```bash
npm install
```

或者手动安装：

```bash
npm install xlsx
```

## 使用方法

### 方法1：使用默认文件名

```bash
npm run read-excel
```

这将读取当前目录下的 `实验室网页.xlsx` 文件。

### 方法2：指定文件路径

```bash
node excel-reader.js /path/to/your/excel-file.xlsx
```

### 方法3：使用 npm 脚本

```bash
npm run read-excel-with-path
```

## 输出文件

脚本执行后会生成两个文件：

1. **JavaScript 格式**: `js/data/member-data-from-excel.js`
   - 可直接在网站中使用的 JavaScript 数据文件
   - 包含完整的数据结构和导出语句

2. **JSON 格式**: `member-data-from-excel.json`
   - 纯 JSON 格式的数据文件
   - 便于其他工具处理或查看

## 数据转换规则

- **姓名**: 直接使用 Excel 中的值
- **ID**: 基于姓名自动生成（去除特殊字符，转小写）
- **年份**: 从"入学时间/学院"字段提取4位数字年份
- **学院**: 根据关键词自动识别或使用原文
- **研究兴趣**: 支持逗号、分号、换行等分隔符
- **个人主页**: 直接使用 Excel 中的 URL
- **自传**: 直接使用，如为空则生成默认描述

## 注意事项

1. **Excel 文件编码**: 建议使用 UTF-8 编码保存 Excel 文件
2. **必填字段**: 至少需要填写姓名字段
3. **数据清洗**: 脚本会自动清理空白字符和空值
4. **重复处理**: 相同姓名会覆盖之前的记录

## 错误处理

如果遇到错误，请检查：

1. Excel 文件是否存在
2. 文件是否被其他程序占用
3. 表头名称是否正确
4. 数据格式是否符合要求

## 集成到网站

生成的 `member-data-from-excel.js` 文件可以：

1. 直接替换现有的 `js/data/member-data.js`
2. 或者与现有数据合并使用

## 示例 Excel 数据

| Name | Email | 入学时间/学院 | 研究兴趣 | 个人主页 | 自传 |
|------|-------|---------------|----------|----------|------|
| 张三 (Zhang San) | zhangsan@jlu.edu.cn | 2023/计算机科学与技术学院 | 机器学习,深度学习 | https://zhangsan.com | 张三是一名专注于机器学习的研究生 |
| 李四 (Li Si) | lisi@jlu.edu.cn | 2024/软件学院 | 软件工程,系统设计 |  | 李四在软件工程方面有丰富经验 |
